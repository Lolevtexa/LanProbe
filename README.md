# LanProbe

LanProbe — это кроссплатформенная библиотека на C#, которая
помогает исследовать локальную сеть. Она предоставляет API для
получения информации о хостах и службах без использования
внешних инструментов. Проект изначально состоял из набора
вспомогательных классов; в данной версии его концепция
переписана таким образом, чтобы являться полноценной библиотекой (API)
с примерами использования.

## Возможности

LanProbe собирает в себе несколько независимых компонентов, каждый из
которых решает отдельную задачу сетевого исследования. Ниже приведён
краткий обзор доступных классов и их назначение:

| Компонент | Назначение |
|----------|-----------|
| `Net/Arp` | Получение MAC‑адреса для заданного IPv4 адреса с помощью системного вызова SendARP (работает только под Windows). |
| `Net/PortScanner` | Асинхронное сканирование списка TCP‑портов на удалённом хосте. |
| `Net/NetworkInfo` | Получение информации о сетевом интерфейсе: текущий IP и маска, вычисление подсети, перечисление всех хостов в подсети. |
| `Discovery/NbnsDiscovery` | Отправка широковещательных NBNS‑запросов и извлечение имён устройств по протоколу NetBIOS. |
| `Discovery/MdnsDiscovery` | Запрос mDNS‑служб (например, `_services._dns-sd._udp.local`) и сбор ответов. |
| `Discovery/SsdpDiscovery` | Определение UPnP/SSDP‑устройств путём отправки и получения M‑SEARCH. |
| `Probes/HttpProbe` | Получение баннера HTTP/HTTPS сервера, TLS CN и других заголовков. |
| `Probes/SshProbe` | Чтение баннера SSH‑службы. |
| `Probes/RdpProbe` | Извлечение CN из сертификата RDP‑сервера. |
| `Probes/PjlProbe` | Выполнение PJL‑команды и чтение идентификатора принтера/MFP. |
| `Models/Device` | Модель, описывающая сетевое устройство: IP, MAC, открытые порты и другие атрибуты. |
| `Utils/StreamHelpers` | Вспомогательные методы для чтения потоков. |
| `Utils/ProgressBar` | Красивая текстовая прогресс‑бар для консольных приложений. |
| `Utils/ReportWriter` | Сохранение собранных данных в форматах JSON, CSV и текст. |

## Структура репозитория

```
lanprobe/
├── LanProbe/               # основной проект библиотеки (class library)
│   ├── LanProbe.csproj
│   ├── Net/
│   ├── Probes/
│   ├── Discovery/
│   ├── Models/
│   └── Utils/
├── LanProbe.Example/       # пример использования библиотеки
│   ├── LanProbe.Example.csproj
│   └── Program.cs
└── README.md
```

## Сборка и использование

LanProbe использует .NET 9 (совместим с .NET 8). Для сборки всех проектов можно выполнить:

```bash
dotnet build
```

После сборки вы можете использовать классы библиотеки напрямую или
обратиться к примеру в папке `LanProbe.Example`. Пример ниже
показывает, как получить MAC‑адрес для узла и отсканировать его
на наличие открытых портов:

```csharp
using LanProbe.Net;
using System.Net;

// создаём IP‑адрес для теста
var ip = IPAddress.Parse("192.168.1.1");

// Получаем MAC‑адрес
var mac = Arp.TryGetMac(ip) ?? "(не найден)";
Console.WriteLine($"MAC для {ip}: {mac}");

// Сканируем несколько TCP‑портов
int[] ports = { 22, 80, 443 };
var open = await PortScanner.Scan(ip, ports, TimeSpan.FromSeconds(1));
Console.WriteLine("Открытые порты: " + string.Join(", ", open));

// Вызовы discovery и проб могут выполняться в аналогичном стиле.
```

Пример консольного приложения с более подробной демонстрацией содержится
в каталоге `LanProbe.Example`. Для его запуска выполните:

```bash
dotnet run --project LanProbe.Example -- 192.168.1.1
```

В качестве аргумента укажите IP‑адрес устройства, которое хотите
просканировать.

## Документация в коде

Каждый публичный класс и метод снабжён XML‑комментариями, которые
отображаются в IDE и генерируемой документации. Комментарии содержат
краткое описание назначения, параметров и возвращаемых значений.

## Лицензия

Этот проект распространяется без лицензии и предоставляется «как есть»
в образовательных целях.